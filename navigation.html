<!DOCTYPE html>
<html>
  <head>
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>
    <link type="text/css" rel="stylesheet" href="css/navigation.css">
    <!--Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Staatliches&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Libre+Baskerville&display=swap" rel="stylesheet">

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <script>

    //     #ffc107          main color
    //#4507ff & #07c1ff     alternate these colors

    var path = atob(window.location.search.slice(1)).split(",");
    console.log(path);
    console.log(path[-2] + " to " + path[-1]);

    </script>
    <div id="map"></div>
    <script>
      var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 41.200665, lng: -96.193945},
          zoom: 15,
          disableDefaultUI: true,
          styles:
            [
                {
                    "featureType": "all",
                    "elementType": "labels.text.fill",
                    "stylers": [
                        {
                            "saturation": 36
                        },
                        {
                            "color": "#000000"
                        },
                        {
                            "lightness": 40
                        }
                    ]
                },
                {
                    "featureType": "all",
                    "elementType": "labels.text.stroke",
                    "stylers": [
                        {
                            "visibility": "on"
                        },
                        {
                            "color": "#000000"
                        },
                        {
                            "lightness": 16
                        }
                    ]
                },
                {
                    "featureType": "all",
                    "elementType": "labels.icon",
                    "stylers": [
                        {
                            "visibility": "off"
                        }
                    ]
                },
                {
                    "featureType": "administrative",
                    "elementType": "geometry.fill",
                    "stylers": [
                        {
                            "color": "#000000"
                        },
                        {
                            "lightness": 20
                        }
                    ]
                },
                {
                    "featureType": "administrative",
                    "elementType": "geometry.stroke",
                    "stylers": [
                        {
                            "color": "#000000"
                        },
                        {
                            "lightness": 17
                        },
                        {
                            "weight": 1.2
                        }
                    ]
                },
                {
                    "featureType": "landscape",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#000000"
                        },
                        {
                            "lightness": 20
                        }
                    ]
                },
                {
                    "featureType": "poi",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#000000"
                        },
                        {
                            "lightness": 21
                        }
                    ]
                },
                {
                    "featureType": "road.highway",
                    "elementType": "geometry.fill",
                    "stylers": [
                        {
                            "lightness": "0"
                        },
                        {
                            "saturation": "100"
                        },
                        {
                            "visibility": "on"
                        },
                        {
                            "color": "#ff6f00"
                        }
                    ]
                },
                {
                    "featureType": "road.highway",
                    "elementType": "geometry.stroke",
                    "stylers": [
                        {
                            "color": "#000000"
                        },
                        {
                            "lightness": 29
                        },
                        {
                            "weight": 0.2
                        }
                    ]
                },
                {
                    "featureType": "road.highway.controlled_access",
                    "elementType": "geometry.fill",
                    "stylers": [
                        {
                            "visibility": "on"
                        }
                    ]
                },
                {
                    "featureType": "road.arterial",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#000000"
                        },
                        {
                            "lightness": 18
                        }
                    ]
                },
                {
                    "featureType": "road.arterial",
                    "elementType": "geometry.fill",
                    "stylers": [
                        {
                            "color": "#ffa000"
                        }
                    ]
                },
                {
                    "featureType": "road.local",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#000000"
                        },
                        {
                            "lightness": 16
                        }
                    ]
                },
                {
                    "featureType": "road.local",
                    "elementType": "geometry.fill",
                    "stylers": [
                        {
                            "color": "#ffd54f"
                        }
                    ]
                },
                {
                    "featureType": "transit",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#000000"
                        },
                        {
                            "lightness": 19
                        }
                    ]
                },
                {
                    "featureType": "water",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#2e2e2e"
                        },
                        {
                            "lightness": 17
                        }
                    ]
                }
            ]
        });
      }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC7zQjQVK6k2btSIrJNDA_D0AJyFdIjQOc&callback=initMap"
    async defer></script>

    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-analytics.js"></script>

    <script id="initialize firebase here">
      // Your web app's Firebase configuration
      var firebaseConfig = {
        apiKey: "AIzaSyAc5mhmmkk7_dxos4Iab7wkBBnoRUxl9vg",
        authDomain: "ridr-web.firebaseapp.com",
        databaseURL: "https://ridr-web.firebaseio.com",
        projectId: "ridr-web",
        storageBucket: "ridr-web.appspot.com",
        messagingSenderId: "681471467832",
        appId: "1:681471467832:web:1135aa1bc6d7f3a90821cd",
        measurementId: "G-NPWTWSJVXX"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();
    </script>

    <script id="pull locations from bikeshare">

    function showBusStops(map, locations){
      var counter = 0
      for(loc in locations){
        var img = 'icons/bus.png';
        var lat = locations[loc]["stop_lat"];
        var lon = locations[loc]["stop_lon"];
        var marker = new google.maps.Marker({
          position: new google.maps.LatLng(lat,lon),
          map: map,
          title: 'bus stops',
          icon: img
        });
        console.log("marker")
      }
    }

    var ref = firebase.database().ref('locations/ometro/');
    var busStops;
    ref.on("value", function(snapshot) {
      // showBusStops(map, snapshot.val())
    }, function (error) {
      console.log("Error: " + error.code);
    });

    </script>

    <script id="pull locations from bikeshare">

    function showBikes(map, locations){
      for(var i = 0; i < locations.length; i++){
        var latlng = locations[i].split(", ").map(Number);
        var lat = latlng[0]; var lng = latlng[1];
        var image = './icons/bike.png'
        var marker = new google.maps.Marker({
          position: {lat, lng},
          map: map,
          title: 'bikeshare',
          icon: image
        });
      }
    }

    var ref = firebase.database().ref('locations/bikeshare/');
    var bikes;
    ref.on("value", function(snapshot) {
      showBikes(map, snapshot.val())
    }, function (error) {
      console.log("Error: " + error.code);
    });

    </script>
    <script id="center map on geolocation">
    function success(pos) {
      console.log('Your current position is:');
      console.log(`Latitude : ${pos.coords.latitude}`);
      console.log(`Longitude: ${pos.coords.longitude}`);
      console.log(`More or less ${pos.coords.accuracy} meters.`);
      var lat = pos.coords.latitude; var lng = pos.coords.longitude;
      map.setCenter({lat,lng});
    }

    function error(err) {
      console.warn(`ERROR(${err.code}): ${err.message}`);
    }

    navigator.geolocation.getCurrentPosition(success, error, null);
    </script>
    <!--JavaScript at end of body for optimized loading-->
    <script type="text/javascript" src="js/materialize.min.js"></script>

  </body>
  </html>
